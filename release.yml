Release:
  stage: build
  script:
    - echo $CI_MERGE_REQUEST_SOURCE_BRANCH_NAME
    - echo $CI_MERGE_REQUEST_EVENT_TYPE
    - mkdir ~/foam
    - cp -r /home/administrator/foam/foam-extend-4.1/ ~/foam || echo
    - source ~/foam/foam-extend-4.1/etc/bashrc
    - ./src/Allwmake
  tags:
    - linux

Tests:
  stage: test
  script:
    - mkdir ~/foam
    - cp -r /home/administrator/foam/foam-extend-4.1/ ~/foam || echo
    - source ~/foam/foam-extend-4.1/etc/bashrc
    - cd ./run/dropletInShearFlowSmall/
    - CahnHilliardFoam
  needs:
    - Release
  rules:
    - changes:
      - ./*
  tags:
    - linux
